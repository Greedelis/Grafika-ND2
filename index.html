<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Three JS Example</title>
    <script type="text/javascript" src="libs/three.js"></script>
    <script type="text/javascript" src="libs/jquery-1.9.0.js"></script>
    <script type="text/javascript" src="libs/OrbitControls.js"></script>
    
    <script type="text/javascript" src="libs/stats.js"></script>
    <script type="text/javascript" src="libs/dat.gui.js"></script>
    <style>
        body{
            /* set margin to 0 and overflow to hidden, to go fullscreen */
            margin: 0;
            overflow: hidden;
        }
    </style>
  </head>
  <body>

    <div id="WebGL-output">
    </div>
    <script type="text/javascript">

      // once everything is loaded, we run our Three.js stuff.
     

    // once everything is loaded, we run our Three.js stuff.
    $(function () {
      
      class metalo_construkcija{
        static group;
        static single_geometry;
        static single_material;
        static single;
        static cube_geometry;
        static cube_mesh;
        static cilinder_geometry1;
        static cilinder_geometry2;
        static cilinder_mesh1;
        static cilinder_mesh2;

        constructor(){
          this.cilinder_geometry1 = new THREE.CylinderGeometry(1, 1, 5, 25);
          this.cilinder_geometry2 = new THREE.CylinderGeometry(0.8, 0.8, 5, 25);
          this.cube_geometry = new THREE.CubeGeometry(2, 1.1, 1);
          this.single_material = new THREE.MeshBasicMaterial ({color: 0x0000ff});
          this.cube_mesh = new THREE.Mesh(this.cube_geometry, new THREE.MeshBasicMaterial ({color: 0xff00ff}));
          this.cilinder_mesh1 = new THREE.Mesh(this.cilinder_geometry1, this.single_material);
          this.cilinder_mesh2 = new THREE.Mesh(this.cilinder_geometry2);
          this.group = new THREE.Group();
          this.cube_mesh.position.set(1.7,1.85,0);
          this.cilinder_mesh2.position.set(3.2,3.75, 0);
          this.group.add(this.cube_mesh);
          this.group.add(this.cilinder_mesh1);
          this.group.add(this.cilinder_mesh2);
         
        }
        set_position(x, y, z){
          this.group.position.set(x,y,z);
        }
       
      }
      var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera( 
          45, 
          window.innerWidth / window.innerHeight, 
          0.1, 
          1000 );

      var renderer = new THREE.WebGLRenderer();
      renderer.setClearColor(0xEEEEEE);
      const datGui  = new dat.GUI({ autoPlace: true });
  
      datGui.domElement.id = 'gui' 
      renderer.setSize( window.innerWidth, window.innerHeight );
      var controls = new THREE.OrbitControls( camera, renderer.domElement );
      let dalys = [];
      var params = new function(){
        this.deg = 180;
        this.step_count = 10;
      }
      init();
      datGui.add(params, "step_count", 2, 40);
      datGui.add(params, "deg", 0, 360).onChange(init());
      camera.position.z = 20;
      camera.rotat
      function animate(){
        requestAnimationFrame(animate);
        let vec = new THREE.Vector3();
        dalys[0].group.rotation.y = 0;
        for(i = 1; i < params.step_count; i++){
          dalys[i].group.rotation.y = (params.deg/(params.step_count-2)) * i * Math.PI/180;
          dalys[i-1].cilinder_mesh2.getWorldPosition(vec);
          dalys[i].group.position.set(vec.x,vec.y+1,vec.z);
        } 
        controls.update();
        renderer.render(scene, camera);
      }

      $("#WebGL-output").append(renderer.domElement);
      animate();

      function init(){
        dalys = [];
        for(i = 0; i < params.step_count; i++){
          dalys.push(new metalo_construkcija());
          scene.add(dalys[i].group);
        } 
      }
  });




  </script>
  </body>
</html>
